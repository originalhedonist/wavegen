var toplength := 4*sin((pi/2)*(n/N))^2;
if (mem0 > 0 and x > mem0 and x < mem0 + toplength)
{
    1
}
else if (mprev > 0 and m <= 0)
{
    mem0 := x; mem1 += toplength; 1
}
else
{
    (1+sin(x - mem1))/2
}
